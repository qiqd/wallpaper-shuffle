# WallpaperShuffle

WallpaperShuffle 是一款 Windows 应用程序，允许用户通过自定义配置实现不同类型壁纸的在线获取，并确保每次随机更换的壁纸都是不同的。该应用要求以管理员权限启动，以便实现所有功能。

## 功能亮点

- **在线获取壁纸**：从指定的数据源动态加载壁纸。
- **随机壁纸**：每次更换时保证壁纸是不同的。
- **自定义配置**：通过 JSON 文件轻松配置壁纸来源和其他参数。
- **开机自启动**：设置为开机自动运行（需要管理员权限）。
- **高权限支持**：确保在需要时以最高权限运行。

## 使用指南

### 一、启用幻灯片放映

1. 打开“设置”。
2. 选择“个性化”。
3. 点击“背景”选项卡。
4. 将背景类型设置为“幻灯片放映”。
5. 指定壁纸文件夹：在幻灯片放映设置中，选择图像文件夹。请将该文件夹设置为本应用下载和保存壁纸的目录。这样，应用下载的新壁纸会自动加入到幻灯片放映中。

### 二、修改壁纸源

壁纸源信息通过一个 JSON 文件进行配置，格式如下：

```json
[
  {
    "title": "Bing每日随机壁纸",
    "url": "https://bing.img.run/rand_uhd.php",
    "arguments": ["width=1090", "height=9090"]
  }
]
```

- `title`：壁纸源的名称。
- `url`：获取壁纸的 API 地址。
- `arguments`：请求时携带的路径参数。例如，您可以指定图片的宽度和高度等参数。如果需要传递参数，请将其写为数组形式，如 `["width=1090", "height=9090"]`；如果没有参数，则写为 `null`。

### 三、安装与运行

#### 安装

1. 下载最新的安装包并运行。
2. 按照提示完成安装过程。
3. 如果希望应用程序在开机时自动运行，请确保在首次运行时以管理员身份运行应用程序，并按照以下步骤操作。

#### 运行

由于 WallpaperShuffle 需要访问系统级别的资源，因此它**必须以管理员权限运行**。请遵循以下步骤启动应用程序：

- 右键点击桌面快捷方式或开始菜单中的图标，选择“以管理员身份运行”。

### 四、设置开机自启动

为了使 WallpaperShuffle 在开机时自动启动，您需要执行以下步骤：

1. **首次运行**：首次使用 WallpaperShuffle 时，请确保以管理员身份运行。这将允许应用程序设置任务计划程序项，以便在开机时自动以最高权限运行。
2. **验证设置**：可以通过任务计划程序确认任务是否已正确设置。打开任务计划程序，导航到“任务计划程序库”，查找名为“WallpaperShuffle”的任务。

### 五、常见问题

#### 1. 我不是管理员，能否使用该应用？

- WallpaperShuffle 必须以管理员权限运行才能正常工作。如果您没有管理员权限，请联系您的系统管理员协助安装和运行。

#### 2. 为什么需要管理员权限？

- WallpaperShuffle 提供的功能（如开机自启动、访问受保护资源等）需要管理员权限来确保其能够正确执行。
